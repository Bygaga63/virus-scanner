version: '3'

services:

  scanner:
    restart: always
    build:
      context: scanner/clamav/docker
      dockerfile: Dockerfile
    ports:
      - 3310:3310
    expose:
      - 3310
    networks:
      network:
        aliases:
          - scanner-network

  api:
    restart: always
    build:
      context: nodejs-rest-client/
      dockerfile: Dockerfile
    depends_on:
      - scanner
    ports:
      - 1337:1337
    expose:
      - 1337
    env_file:
      - env/api.env
    networks:
      network:
        aliases:
          - scanner-network

networks:

  network:
    driver: bridge
    driver_opts:
      com.docker.network.bridge.enable_ip_masquerade: "true"
      com.docker.network.bridge.enable_icc: "true"